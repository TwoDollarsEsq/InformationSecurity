# LAB4

–£ —Ü—ñ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ –±—É–ª–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º **RSA**. <br>
RSA ‚Äî —Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, —â–æ —Ç–∏–º —á–∏ —ñ–Ω—à–∏–º —á–∏–Ω–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Å—å–æ–≥–æ–¥–µ–Ω–Ω—ñ –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–¥–∞—á—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç.

## –õ—ñ—Å—Ç—ñ–Ω–≥
<span style="color:red">**Disclamer**:</span>
–¶—é —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –Ω–µ —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —É —Ä–µ–∞–ª—å–Ω—ñ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ. –í–µ—Ä—Å—ñ—è —É —Ü—ñ–π —Ä–æ–±–æ—Ç—ñ –Ω–∞—Ü—ñ–ª–µ–Ω–∞ –Ω–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—é –ø—Ä–∏–Ω—Ü–∏–ø—É –∞–ª–≥–æ—Ä–∏—Ç–º—É, –∞ –Ω–µ –Ω–∞ –≤—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —É—Å—ñ—Ö —Ç–æ–Ω–∫–∏—Ö(—ñ –Ω–µ –¥—É–∂–µ) –Ω—é–∞–Ω—Å—ñ–≤ RSA.
<hr>
–Ø–¥—Ä–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ RSA.swift
<br>
–¢—É—Ç –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è, —â–æ –º–æ–∂–µ –∫–æ—Ä–µ–∫—Ç–Ω–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø–∞—Ä—É –∑ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –π –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞, –≥–µ–Ω–µ—Ä—É—é—á–∏ –¥–≤–∞ –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–ª–∞ –∑–∞–¥–∞–Ω–æ—ó –¥–æ–≤–∂–∏–Ω–∏ –≤ –±—ñ—Ç–∞—Ö —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ—é –ï–π–ª–µ—Ä–∞.
<br>

```swift
//
//  RSA.swift
//  Lab4
//

import BigInt

public typealias Key = (modulus: BigUInt, exponent: BigUInt)

public func generateKeyPair(
    of width: Int = 1024,
    with exponent: BigUInt = 65537
) -> (public: Key, private: Key) {
    let p = generatePrime(width), q = generatePrime(width), n = p * q
    let e = exponent, ùúô = (p - 1) * (q - 1), d = e.inverse(ùúô)! // d * e % ùúô == 1
    
    return ((n, e), (n, d))
}
```

–ö—Ä—ñ–º —Ç–æ–≥–æ, —É —Ü—å–æ–º—É —Ñ–∞–π–ª—ñ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è `encrypt`. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–µ—ó –º–æ–∂–Ω–∞ —è–∫ —à–∏—Ñ—Ä—É–≤–∞—Ç–∏ —Ç–∞–∫ —ñ –¥–µ—à–∏—Ñ—Ä—É–≤–∞—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–∏–≤–∞—Ç–Ω–∏–º –∫–ª—é—á–µ–º –≤–∏—Ö—ñ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
```swift
public func encrypt(_ message: BigUInt, key: Key) -> BigUInt {
    message.power(key.exponent, modulus: key.modulus) // m^e % n
}
```

–¢–µ—Å—Ç–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ `RSATests.swift`:
```swift
func testExample() {
    let (`public`, `private`) = generateKeyPair()
    print("Generated: \(`public`), \(`private`)")
    
    let message    = BigUInt(Data(
        """
        LizardScript is the future of mankind!ü¶é

        Check out LizardScript at github.com/killer-nyasha/lizardscript
        Copyright ¬© 2020 Bydlosoft-Incorporated
        """.utf8))
    let cyphertext = encrypt(message,    key: `public`)
    let plaintext  = encrypt(cyphertext, key: `private`)
    let received   = String(decoding: plaintext.serialize(), as: UTF8.self)
    
    print(received)
    XCTAssert(message == plaintext)
}
```
–û—Å–∫—ñ–ª—å–∫–∏ –∑—ñ–±—Ä–∞—Ç–∏ Swift Package(—Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ–µ–∫—Ç—É) –Ω–µ –º–æ–∂–Ω–∞ –Ω–∞ –∫–æ–∂–Ω—ñ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ, –ø—Ä–∏–≤–µ–¥–µ–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É:
```
Test Suite 'All tests' started at 2020-05-06 11:54:59.597
Test Suite 'RSATests.xctest' started at 2020-05-06 11:54:59.598
Test Suite 'RSATests' started at 2020-05-06 11:54:59.598
Test Case '-[RSATests.RSATests testExample]' started.
Generated: (modulus: 18299882276849829975985334383810053803602958449069521652783896483357302208143311898329002478071715135496520434146681405060385532661768889263303626006434795411831710650161989340508436925202620260550602742593053603790646135467931951807297250091402679580172250462282288615064973253053872805257967897811478521381953297459471030050037336646724054580857304535275708049761925099189246393820860998988178943567067602557403575640046767945387490722466791460657961223964519894270086017720047773143670012765060865674480179122269667327168827494651621501891198337546287928133807974118327986839799223513994858068697777689815484591587, exponent: 65537), (modulus: 18299882276849829975985334383810053803602958449069521652783896483357302208143311898329002478071715135496520434146681405060385532661768889263303626006434795411831710650161989340508436925202620260550602742593053603790646135467931951807297250091402679580172250462282288615064973253053872805257967897811478521381953297459471030050037336646724054580857304535275708049761925099189246393820860998988178943567067602557403575640046767945387490722466791460657961223964519894270086017720047773143670012765060865674480179122269667327168827494651621501891198337546287928133807974118327986839799223513994858068697777689815484591587, exponent: 8619264936170415974162920209338980130454798379631017507333770490688820125440098748456896844425556598600890989231117713831941965946007325232764031426013233208300978750159456291298265575280444362767230807915564927320592412066834360565598845168704974491977921285224067091411349228302591600968963380527712879716950469464068050643416291605149235457136134073568318646944295373570735644425091809498970808499157282762791904996870519495092471406698235884477927342921590543149104086228199311363174453927923102616870829109585083094442422198948068750052587843976066239114779324984511977742722532412456231851491236182013974742817)
LizardScript is the future of mankind!ü¶é

Check out LizardScript at github.com/killer-nyasha/lizardscript
Copyright ¬© 2020 Bydlosoft-Incorporated
Test Case '-[RSATests.RSATests testExample]' passed (146.966 seconds).
Test Suite 'RSATests' passed at 2020-05-06 11:57:26.565.
	 Executed 1 test, with 0 failures (0 unexpected) in 146.966 (146.967) seconds
Test Suite 'RSATests.xctest' passed at 2020-05-06 11:57:26.566.
	 Executed 1 test, with 0 failures (0 unexpected) in 146.966 (146.968) seconds
Test Suite 'All tests' passed at 2020-05-06 11:57:26.566.
	 Executed 1 test, with 0 failures (0 unexpected) in 146.966 (146.969) seconds
Program ended with exit code: 0
```

–í–∏–¥–Ω–æ, —â–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–µ –≤–∏—Ö—ñ–¥–Ω–æ–º—É, –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–∏–≤—Å—è —É—Å–ø—ñ—à–Ω–æ. –°–∞–º–µ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞–∫–æ–∂ –≤–∏–≤–µ–¥–µ–Ω–µ —É –∫–æ–Ω—Å–æ–ª—å.